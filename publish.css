/* 1. ГЕОМЕТРИЯ (БЕЗ ИЗМЕНЕНИЙ) */
.callout[data-callout="problem"] {
    --callout-color: 6, 121, 167; 
    border: 2px solid #0679a7 !important; 
    border-radius: 6px !important;
    margin: 15px 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    padding-bottom: 0px !important;
}

.callout[data-callout="problem"] > .callout-title {
    background-color: #0679a7 !important; 
    padding: 8px 15px !important;
    color: #ffffff !important; 
    font-weight: bold !important;
}

.callout[data-callout="problem"] > .callout-content {
    padding: 15px 15px 5px 15px !important;  
}

.callout[data-callout="problem"] .callout[data-callout="answer"] {
    border: none !important;
    border-top: 1px solid #0679a7 !important; 
    margin-top: 15px !important; 
    margin-left: -15px !important;
    margin-right: -15px !important;
    padding: 8px 15px 5px 15px !important; 
}

.task-layout {
    display: flex !important;
    flex-direction: row !important;
    gap: 20px !important;
    align-items: flex-start !important;
}

.task-image {
    flex: 0 0 auto !important;
    max-width: 250px !important;
    text-align: right !important;
}

/* 2. ЛОГИКА ТЕМНОЙ ТЕМЫ ДЛЯ БРАУЗЕРА */
@media (prefers-color-scheme: dark) {
    /* Инверсия для браузера (когда нет классов Obsidian) */
    :not(.theme-light):not(.theme-dark) body {
        filter: invert(0.92) hue-rotate(180deg) !important;
        background-color: #050505 !important;
    }

    /* Исправление цветов для шапок и картинок после инверсии */
    :not(.theme-light):not(.theme-dark) .callout[data-callout="problem"] > .callout-title,
    :not(.theme-light):not(.theme-dark) img,
    :not(.theme-light):not(.theme-dark) .callout-fold-icon {
        filter: invert(1) hue-rotate(180deg) !important;
    }
}

/* 3. ЛОГИКА АДАПТАЦИИ ЦВЕТОВ (ИСПРАВЛЕНО) */

/* Цвета для OBSIDIAN (Dark) */
.theme-dark .callout[data-callout="problem"],
.theme-dark .callout[data-callout="problem"] .callout-content {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
}

/* Цвета для ВСЕХ ОСТАЛЬНЫХ СЛУЧАЕВ (Light Obsidian + Браузер) */
/* Мы ПРИНУДИТЕЛЬНО задаем белый фон, чтобы инверсия в браузере сработала корректно */
.callout[data-callout="problem"],
.theme-light .callout[data-callout="problem"],
.callout[data-callout="problem"] .callout-content {
    background-color: #ffffff !important;
    color: #000000 !important;
}

/* Фикс для вложенного ответа в светлой теме/браузере */
.callout[data-callout="problem"] .callout[data-callout="answer"] {
    background-color: #ffffff !important;
}

/* Текст заголовка "Ответ" */
.callout[data-callout="problem"] .callout[data-callout="answer"] > .callout-title {
    color: #747474 !important;
}

/* Цвета текста "Ответ" для Obsidian Dark */
.theme-dark .callout[data-callout="problem"] .callout[data-callout="answer"] > .callout-title {
    color: var(--text-muted) !important;
}
.theme-dark .callout[data-callout="problem"] .callout[data-callout="answer"] {
    background-color: transparent !important;
}